<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Panel de Usuarios</title>
  <link rel="stylesheet" href="../CSS/list_usu.css">
</head>
<body>
  <div class="container">
    <aside class="sidebar">
      <div class="logo">
        <img src="/VistaTienda/IMG/icon-level-up.png" alt="Logo"> 
        <span>Level-Up</span>
      </div>
      <nav class="menu">
        <a href="Home_ad.html">📊 Dashboard</a>
        <a href="listado_produc.html">📦 Inventario</a>
        <a href="#">📑 Reportes</a>
        <a href="listado_usuario.html" class="active">👨‍💼 Empleados</a>
        <a href="#">👥 Clientes</a>
      </nav>
      <div class="bottom-menu">
        <a href="#">⚙️ Configuración</a>
        <a href="#">🙍 Perfil</a>
        <a href="#">❓ Help</a>
      </div>
      <div class="profile">
        <span>👤</span> Profile
      </div>
    </aside>

    <div class="main-content">
      <div class="main-header">
        <h1>Usuarios</h1>
        <a href="registro_usuario.html">
          <button class="btn-nuevo">NUEVO USUARIO</button>
        </a>
      </div>

      <div class="content-box">
        <table id="usersTable">
          <thead>
            <tr>
              <th>Fecha</th>
              <th>ID Usuario</th>
              <th>Nombre</th>
              <th>Rol</th>
              <th>Teléfono</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>

        <div class="pagination" id="pagination"></div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const storedUsers = JSON.parse(localStorage.getItem('usuarios')) || [];

      const exampleUsers = [
        { date: '2024-06-01', id: 'U001', name: 'Arne Corporation', rol: 'Administrador', telefono: '$2500.00' },
        { date: '2024-06-02', id: 'U002', name: 'Bravo Solutions', rol: 'Usuario estándar', telefono: '$1200.00' },
        { date: '2024-06-03', id: 'U003', name: 'Derricks Workshop', rol: 'Invitado', telefono: '$900.00' }
      ];

      const allUsers = [
        ...exampleUsers,
        ...storedUsers.map((u,index)=>({
          date: u.fecha,
          id: 'U' + String(exampleUsers.length + index + 1).padStart(3,'0'),
          name: u.nombre,
          rol: u.rol,
          telefono: u.telefono || '---'
        }))
      ];

      const rowsPerPage = 5;
      let currentPage = 1;
      const tableBody = document.querySelector('#usersTable tbody');
      const paginationDiv = document.getElementById('pagination');

      function displayTablePage(page){
        tableBody.innerHTML = '';
        const start = (page-1)*rowsPerPage;
        const end = start+rowsPerPage;
        const slice = allUsers.slice(start,end);
        slice.forEach(u=>{
          const row = document.createElement('tr');
          row.innerHTML = `<td>${u.date}</td><td>${u.id}</td><td>${u.name}</td><td>${u.rol}</td><td>${u.telefono}</td>`;
          tableBody.appendChild(row);
        });
      }

      function setupPagination(){
        paginationDiv.innerHTML = '';
        const pageCount = Math.ceil(allUsers.length/rowsPerPage);

        const prevButton = document.createElement('button');
        prevButton.textContent = '«';
        prevButton.disabled = currentPage===1;
        prevButton.onclick = ()=>{ currentPage--; updateTableAndPagination(); };
        paginationDiv.appendChild(prevButton);

        for(let i=1;i<=pageCount;i++){
          const btn = document.createElement('button');
          btn.textContent=i;
          if(i===currentPage) btn.classList.add('active');
          btn.onclick=()=>{ currentPage=i; updateTableAndPagination(); };
          paginationDiv.appendChild(btn);
        }

        const nextButton = document.createElement('button');
        nextButton.textContent='»';
        nextButton.disabled=currentPage===pageCount;
        nextButton.onclick=()=>{ currentPage++; updateTableAndPagination(); };
        paginationDiv.appendChild(nextButton);
      }

      function updateTableAndPagination(){
        displayTablePage(currentPage);
        setupPagination();
      }

      updateTableAndPagination();
    });
  </script>
</body>
</html>
