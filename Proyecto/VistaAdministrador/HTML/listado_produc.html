<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Panel de Productos</title>
  <link rel="stylesheet" href="../CSS/list_prod.css">
</head>
<body>
  <div class="container">
    
    <aside class="sidebar">
      <div class="logo">
        <img src="/VistaTienda/IMG/icon-level-up.png" alt="">Level-Up
      </div>
      <nav class="menu">
        <a href="Home_ad.html">ğŸ“Š Dashboard</a>
        <a href="listado_produc.html" class="active">ğŸ“¦ Inventario</a>
        <a href="#">ğŸ“‘ Reportes</a>
        <a href="listado_usuario.html">ğŸ‘¨â€ğŸ’¼ Empleados</a>
        <a href="#">ğŸ‘¥ Clientes</a>
      </nav>

      <div class="bottom-menu">
        <a href="#">âš™ï¸ ConfiguraciÃ³n</a>
        <a href="#">ğŸ™ Perfil</a>
        <a href="#">â“ Help</a>
      </div>

      <div class="profile">
        <span>ğŸ‘¤</span> Profile
      </div>
    </aside>

    <main class="main-content">
      <header class="main-header">
        <h1>Productos</h1>
        <a href="registro_producto.html">
          <button class="btn-nuevo">NUEVO PRODUCTO</button>
        </a>
      </header>

      <section class="content-box">
        <table id="productsTable">
          <thead>
            <tr>
              <th>Fecha</th>
              <th>ID Producto</th>
              <th>Nombre</th>
              <th>CategorÃ­a</th>
              <th>Stock</th>
              <th>Precio</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <div class="pagination" id="pagination"></div>
      </section>
    </main>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const storedProducts = JSON.parse(localStorage.getItem('productos')) || [];

      const productsExample = [
        { date: '2024-06-01', id: 'P001', name: 'Teclado MecÃ¡nico', category: 'ElectrÃ³nica', stock: 120, price: '$50.00' },
        { date: '2024-06-02', id: 'P002', name: 'Silla Gamer', category: 'Muebles', stock: 30, price: '$150.00' },
        { date: '2024-06-03', id: 'P003', name: 'AudÃ­fonos Bluetooth', category: 'ElectrÃ³nica', stock: 75, price: '$40.00' }
      ];

      const allProducts = [
        ...productsExample,
        ...storedProducts.map((p, index) => ({
          date: p.fecha,
          id: 'P' + String(productsExample.length + index + 1).padStart(3, '0'),
          name: p.nombre,
          category: p.categoria,
          stock: p.stock,
          price: `$${p.precio.toFixed(2)}`
        }))
      ];

      const rowsPerPage = 5;
      let currentPage = 1;

      const tableBody = document.querySelector('#productsTable tbody');
      const paginationDiv = document.getElementById('pagination');

      function displayTablePage(page) {
        tableBody.innerHTML = '';
        const start = (page - 1) * rowsPerPage;
        const end = start + rowsPerPage;
        const slice = allProducts.slice(start, end);

        slice.forEach(p => {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${p.date}</td>
            <td>${p.id}</td>
            <td>${p.name}</td>
            <td>${p.category}</td>
            <td>${p.stock}</td>
            <td>${p.price}</td>
          `;
          tableBody.appendChild(row);
        });
      }

      function setupPagination() {
        paginationDiv.innerHTML = '';
        const pageCount = Math.ceil(allProducts.length / rowsPerPage);

        const prevButton = document.createElement('button');
        prevButton.textContent = 'Â«';
        prevButton.disabled = currentPage === 1;
        prevButton.onclick = () => { currentPage--; updateTableAndPagination(); };
        paginationDiv.appendChild(prevButton);

        for (let i = 1; i <= pageCount; i++) {
          const btn = document.createElement('button');
          btn.textContent = i;
          if (i === currentPage) btn.classList.add('active');
          btn.onclick = () => { currentPage = i; updateTableAndPagination(); };
          paginationDiv.appendChild(btn);
        }

        const nextButton = document.createElement('button');
        nextButton.textContent = 'Â»';
        nextButton.disabled = currentPage === pageCount;
        nextButton.onclick = () => { currentPage++; updateTableAndPagination(); };
        paginationDiv.appendChild(nextButton);
      }

      function updateTableAndPagination() {
        displayTablePage(currentPage);
        setupPagination();
      }

      updateTableAndPagination();
    });
  </script>
</body>
</html>
